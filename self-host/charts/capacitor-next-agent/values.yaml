# Default values for capacitor-agent

# Container image configuration
image:
  repository: ghcr.io/gimlet-io/capacitor-next
  tag: agent-v2025-11.2-rc2
  pullPolicy: IfNotPresent

# Number of replicas
replicaCount: 1

# Resource limits and requests
resources:
  requests:
    cpu: "50m"
    memory: "64Mi"
  limits:
    cpu: "200m"
    memory: "256Mi"

# Service Account
serviceAccount:
  create: true
  name: capacitor-next-agent

# RBAC configuration
rbac:
  create: true
  createImpersonatorRole: true

# Agent configuration
agent:
  # WebSocket URL of the Capacitor server
  # Format: wss://capacitor.example.com/agent/connect
  backendWsUrl: ""  # Required
  
  # Cluster ID - must match the cluster ID configured in the server
  clusterId: ""  # Required
  
  # Shared secret for agent authentication
  # Must match the agentSecret in the server's cluster configuration
  # Generate with: openssl rand -hex 32
  agentSharedSecret: ""  # Required

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity: {}

# Existing secret configuration
# If specified, the deployment will use this secret in addition to the built-in secret
# Both secrets will be loaded via envFrom, allowing you to override or supplement values
existingSecret:
  name: ""  # Name of the existing secret to use

# Security context configuration
securityContext:
  enabled: true
  pod:
    runAsNonRoot: true
    runAsUser: 1000
    seccompProfile:
      type: RuntimeDefault
  container:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: true
    capabilities:
      drop:
        - ALL

